
<!DOCTYPE html>
<html lang="en">
<head>
  <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,400italic' rel='stylesheet' type='text/css'>

    <link rel="stylesheet" type="text/css" href="./theme/stylesheet/style.min.css">

  <!-- <link rel="stylesheet" type="text/css" href="./theme/pygments/github.min.css"> -->
  <link rel="stylesheet" type="text/css" href="./theme/font-awesome/css/font-awesome.min.css">





  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="" />


<meta name="author" content=""Michael Toth"" />
<meta name="description" content="In this post I'm going to be talking about how to easily modify your Pelican blog configuration to let you directly publish blog posts using RMarkdown." />
<meta name="keywords" content="R, Pelican, Blog">
<meta property="og:site_name" content="cmd+build"/>
<meta property="og:title" content="How to Write Pelican Blog Posts using RMarkdown & Knitr"/>
<meta property="og:description" content="In this post I'm going to be talking about how to easily modify your Pelican blog configuration to let you directly publish blog posts using RMarkdown."/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="./how-to-write-pelican-blog-posts-using-rmarkdown-knitr.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2017-02-20 21:52:49-05:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="./author/michael-toth.html">
<meta property="article:section" content="R"/>
<meta property="article:tag" content="R"/>
<meta property="article:tag" content="Pelican"/>
<meta property="article:tag" content="Blog"/>
<meta property="og:image" content="">

  <title>cmd+build &ndash; How to Write Pelican Blog Posts using RMarkdown & Knitr</title>

</head>
<body>
  <aside>
    <div>
      <a href=".">
        <img src="./theme/img/profile.png" alt="" title="">
      </a>
      <h1><a href="."></a></h1>


      <!--  -->

      <ul class="social">
        <li><a class="sc-github" href="https://github.com/tkthomas27" target="_blank"><i class="fa fa-github"></i></a></li>
        <li><a class="sc-linkedin" href="https://www.linkedin.com/in/timothy-thomas-6206134a" target="_blank"><i class="fa fa-linkedin"></i></a></li>
        <li><a class="sc-twitter" href="https://twitter.com/tkylethomas27" target="_blank"><i class="fa fa-twitter"></i></a></li>
      </ul>
    </div>


  </aside>
  <main>

    <nav>
      <a href=".">    Home
</a>

      <a href="/about.html">About</a>
      <a href="/archives.html">Archives</a>
      <a href="/categories.html">Categories</a>
      <a href="/tags.html">Tags</a>


    </nav>

<article class="single">
  <header>
    <h1 id="how-to-write-pelican-blog-posts-using-rmarkdown-knitr">How to Write Pelican Blog Posts using RMarkdown & Knitr</h1>
    <p>
          Posted on Mon 20 February 2017 in <a href="./category/r.html">R</a>


    </p>
  </header>


  <div>
    <p>In this post I'm going to be talking about how to easily modify your Pelican blog configuration to let you directly publish blog posts using RMarkdown. I'm assuming you already have a Pelican blog set up, so I won't be covering that in today's post. If you're interested but haven't yet set up a blog for yourself, it's quite straightforward! I recommend checking out these links:</p>
<ul>
<li><a href="http://docs.getpelican.com/en/stable/quickstart.html">Official Pelican Guide</a></li>
<li><a href="http://duncanlock.net/blog/2013/05/17/how-i-built-this-website-using-pelican-part-1-setup/">Detailed Pelican Setup by Duncan Lock</a></li>
</ul>
<p>Until now, I've been writing posts on this blog using standard markdown. This means I'd do an analysis in R, produce a series of graphs and results that I would store locally in image files, and put it all together on my own in a markdown document. It's not that bad a process, but it is a bit inefficient, and I wanted to see if there was a better way. Luckily, there's a very easy-to-use Pelican plugin called rmd_reader that will automatically convert any RMarkdown posts you have into Pelican-compliant html documents. In figuring out how to set this up, I drew heavily on these resources:</p>
<ul>
<li><a href="https://github.com/getpelican/pelican-plugins/tree/master/rmd_reader">rmd_reader Plugin on Github</a></li>
<li><a href="https://rjweiss.github.io/articles/2014_08_25/testing-rmarkdown-integration/">rmd_reader Setup Tutorial by Rebecca Weiss</a>
<br><br></li>
</ul>
<h3>1 Setup Instructions</h3>
<p>First, let's install the RMD Reader extension so that Pelican knows what to do. We'll do this by cloning the pelican-plugins github repository and referencing this in our Pelican configuration file. This has the added benefit of allowing you to easily use other Pelican plugins, should you decide you want to do that.</p>
<p>Execute the following command from the directory where you want to store this repository.<br />
<em>(Run from terminal):</em></p>
<div class="highlight"><pre><span></span>git clone --recursive https://github.com/getpelican/pelican-plugins
</pre></div>


<p>Add the following to your Pelican config file. If you already have these variables defined, simple add the new path and plugin to the end of your existing list.<br />
<em>(Edit pelicanconf.py):</em></p>
<div class="highlight"><pre><span></span><span class="n">PLUGIN_PATHS</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;your-path-to/pelican-plugins&#39;</span><span class="p">]</span>
<span class="n">PLUGINS</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;rmd_reader&#39;</span><span class="p">]</span>
</pre></div>


<p>Make sure you have the rpy2 python package installed.<br />
<em>(Run from terminal):</em></p>
<div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">rpy2</span>
</pre></div>


<p>Also make sure you have the knitr R package installed.<br />
<em>(Run from R):</em></p>
<div class="highlight"><pre><span></span>install.packages<span class="p">(</span><span class="s">&#39;knitr&#39;</span><span class="p">)</span>
</pre></div>


<p><br></p>
<h3>2 Additional Setup</h3>
<p>The above is the core setup, but there are a few more tweaks that I recommend you do in order to make your life easier down the road.</p>
<p>Add the following to your Pelican config file. Essentially what we're doing here is giving knitr instructions on how to name &amp; where to store image files to reduce the likelihood of you having conflicts and overwriting files from older blog posts. There are several ways to do this, but this seemed the best solution to me. For further details, check out the <a href="https://github.com/getpelican/pelican-plugins/tree/master/rmd_reader">official rmd_reader documentation</a>.<br />
<em>(Edit pelicanconf.py):</em></p>
<div class="highlight"><pre><span></span><span class="n">STATIC_PATHS</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;figure&#39;</span><span class="p">]</span>
<span class="n">RMD_READER_RENAME_PLOT</span> <span class="o">=</span> <span class="s1">&#39;directory&#39;</span>
<span class="n">RMD_READER_KNITR_OPTS_CHUNK</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;fig.path&#39;</span><span class="p">:</span> <span class="s1">&#39;figure/&#39;</span><span class="p">}</span>
</pre></div>


<p><br></p>
<h3>3 Testing &amp; Examples</h3>
<p>Finally, we're ready to test out our new setup. Try this out with your own .Rmd document or use this one, <a href="https://raw.githubusercontent.com/michaeltoth/michaeltoth/master/content/pelican_rmarkdown_setup.Rmd">available on my Github</a>, if you're just looking for a quick test. The steps are relatively simple:</p>
<ol>
<li>Save your .Rmd file into the same content folder where you'd put any other .md file for your Pelican blog</li>
<li>Run your Pelican blog like you would normally. </li>
</ol>
<p>That's it. rmd_reader will automatically execute your .Rmd file, produce the relevant graphics, and set up the html for your blog just like base Pelican would.</p>
<p>Just to confirm everythng is working correctly, let's do some basic operations on the iris dataset.</p>
<p>First let's see a simple summary of the data:</p>
<div class="highlight"><pre><span></span><span class="kp">summary</span><span class="p">(</span>iris<span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>##   Sepal.Length    Sepal.Width     Petal.Length    Petal.Width   
##  Min.   :4.300   Min.   :2.000   Min.   :1.000   Min.   :0.100  
##  1st Qu.:5.100   1st Qu.:2.800   1st Qu.:1.600   1st Qu.:0.300  
##  Median :5.800   Median :3.000   Median :4.350   Median :1.300  
##  Mean   :5.843   Mean   :3.057   Mean   :3.758   Mean   :1.199  
##  3rd Qu.:6.400   3rd Qu.:3.300   3rd Qu.:5.100   3rd Qu.:1.800  
##  Max.   :7.900   Max.   :4.400   Max.   :6.900   Max.   :2.500  
##        Species  
##  setosa    :50  
##  versicolor:50  
##  virginica :50  
##                 
##                 
## 
</pre></div>


<p>Let's finish with a simple k-means cluster analysis:</p>
<div class="highlight"><pre><span></span><span class="kn">library</span><span class="p">(</span>broom<span class="p">)</span>
<span class="kn">library</span><span class="p">(</span>dplyr<span class="p">)</span>
<span class="kn">library</span><span class="p">(</span>ggplot2<span class="p">)</span>

iris_sub <span class="o">&lt;-</span> select<span class="p">(</span>iris<span class="p">,</span> x1 <span class="o">=</span> Petal.Length<span class="p">,</span> x2 <span class="o">=</span> Petal.Width<span class="p">)</span>

kclusts <span class="o">&lt;-</span> <span class="kt">data.frame</span><span class="p">(</span>k<span class="o">=</span><span class="m">1</span><span class="o">:</span><span class="m">6</span><span class="p">)</span> <span class="o">%&gt;%</span> group_by<span class="p">(</span>k<span class="p">)</span> <span class="o">%&gt;%</span> do<span class="p">(</span>kclust<span class="o">=</span>kmeans<span class="p">(</span>iris_sub<span class="p">,</span> <span class="m">.</span><span class="o">$</span>k<span class="p">))</span>
clusters <span class="o">&lt;-</span> kclusts <span class="o">%&gt;%</span> group_by<span class="p">(</span>k<span class="p">)</span> <span class="o">%&gt;%</span> do<span class="p">(</span>tidy<span class="p">(</span><span class="m">.</span><span class="o">$</span>kclust<span class="p">[[</span><span class="m">1</span><span class="p">]]))</span>
assignments <span class="o">&lt;-</span> kclusts <span class="o">%&gt;%</span> group_by<span class="p">(</span>k<span class="p">)</span> <span class="o">%&gt;%</span> do<span class="p">(</span>augment<span class="p">(</span><span class="m">.</span><span class="o">$</span>kclust<span class="p">[[</span><span class="m">1</span><span class="p">]],</span> iris_sub<span class="p">))</span>
clusterings <span class="o">&lt;-</span> kclusts <span class="o">%&gt;%</span> group_by<span class="p">(</span>k<span class="p">)</span> <span class="o">%&gt;%</span> do<span class="p">(</span>glance<span class="p">(</span><span class="m">.</span><span class="o">$</span>kclust<span class="p">[[</span><span class="m">1</span><span class="p">]]))</span>

ggplot<span class="p">(</span>assignments<span class="p">,</span> aes<span class="p">(</span>x <span class="o">=</span> x1<span class="p">,</span> y <span class="o">=</span> x2<span class="p">))</span> <span class="o">+</span> 
    facet_wrap<span class="p">(</span><span class="o">~</span> k<span class="p">)</span> <span class="o">+</span>
    geom_point<span class="p">(</span>aes<span class="p">(</span>color<span class="o">=</span><span class="m">.</span>cluster<span class="p">))</span> <span class="o">+</span> 
    geom_point<span class="p">(</span>data<span class="o">=</span>clusters<span class="p">,</span> size<span class="o">=</span><span class="m">10</span><span class="p">,</span> shape<span class="o">=</span><span class="s">&quot;x&quot;</span><span class="p">)</span>
</pre></div>


<p><img alt="plot of chunk iris-plot" src="./figure/boxplots-iris-plot-1.png" /></p>
<h3>4 Closing Remarks</h3>
<p>That's it! I've been meaning to get this set up for a while, and I'm pretty excited about it. Since most of my blog posts are R analyses, this is going to really simplify my workflow, which should make it much for me to actually finalize and post my results, something I've had issues with before. I'm also glad I'll be able to make greater use of R Markdown/Knitr, which will help me to organize my thoughts while analyzing as well as create reproducible research documents to share. I hope you find this useful as well!</p>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="./tag/r.html">R</a>
      <a href="./tag/pelican.html">Pelican</a>
      <a href="./tag/blog.html">Blog</a>
    </p>
  </div>




</article>

    <footer>
<p>&copy; kyle thomas </p>
<p>    Powered by <a href="http://getpelican.com" target="_blank">Pelican</a> - <a href="https://github.com/alexandrevicenzi/flex" target="_blank">Flex</a> theme by <a href="http://alexandrevicenzi.com" target="_blank">Alexandre Vicenzi</a>
</p>    </footer>
  </main>





<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " cmd+build ",
  "url" : ".",
  "image": "",
  "description": ""
}
</script>
</body>
</html>