
<!DOCTYPE html>
<html lang="en">
<head>
  <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,400italic' rel='stylesheet' type='text/css'>

    <link rel="stylesheet" type="text/css" href="./theme/stylesheet/style.min.css">

  <!-- <link rel="stylesheet" type="text/css" href="./theme/pygments/github.min.css"> -->
  <link rel="stylesheet" type="text/css" href="./theme/font-awesome/css/font-awesome.min.css">





  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="" />


<meta name="author" content="Kyle Thomas" />
<meta name="description" content="In this post I'm going to walk through the R package ggpairs and how it can help us quickly visualize the relationship between variables." />
<meta name="keywords" content="r, exploratory analysis">
<meta property="og:site_name" content="cmd+build"/>
<meta property="og:title" content="R Exploratory Analysis with ggpairs"/>
<meta property="og:description" content="In this post I'm going to walk through the R package ggpairs and how it can help us quickly visualize the relationship between variables."/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="./r-exploratory-analysis-with-ggpairs.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2017-02-26 20:48:18-05:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="./author/kyle-thomas.html">
<meta property="article:section" content="tech"/>
<meta property="article:tag" content="r"/>
<meta property="article:tag" content="exploratory analysis"/>
<meta property="og:image" content="">

  <title>cmd+build &ndash; R Exploratory Analysis with ggpairs</title>

</head>
<body>
  <aside>
    <div>
      <a href=".">
        <img src="./theme/img/profile.png" alt="" title="">
      </a>
      <h1><a href="."></a></h1>


      <ul class="social">
        <li><a class="sc-github" href="https://github.com/tkthomas27" target="_blank"><i class="fa fa-github"></i></a></li>
        <li><a class="sc-linkedin" href="https://www.linkedin.com/in/timothy-thomas-6206134a" target="_blank"><i class="fa fa-linkedin"></i></a></li>
        <li><a class="sc-twitter" href="https://twitter.com/tkylethomas27" target="_blank"><i class="fa fa-twitter"></i></a></li>
      </ul>
    

      <nav>
        <ul class="list">

          <li><a href="/about.html" target="_blank">About</a></li>
          <li><a href="/archives.html" target="_blank">Archives</a></li>
          <li><a href="/categories.html" target="_blank">Categories</a></li>
          <li><a href="/tags.html" target="_blank">Tags</a></li>
        </ul>
      </nav>

  </div>



  </aside>
  <main>


<article class="single">
  <header>
    <h1 id="r-exploratory-analysis-with-ggpairs">R Exploratory Analysis with ggpairs</h1>
    <p>
          Posted on Sun 26 February 2017 in <a href="./category/tech.html">tech</a>


    </p>
  </header>


  <div>
    <p>Quick visual analysis of data is an essential first step to familiarizing yourself with a dataset. In this note, we will explore rapid exploratory data analysis using some built-in R functions and the more powerful <code>ggpairs</code> tool.</p>
<p>We will be using the banknote authentication data from <a href="http://archive.ics.uci.edu/ml/datasets.html">UCI machine learning repository</a>. This dataset contains five variables: a binary class variable indicating if a banknote is fake or note and four variables of visual data from a scan of each banknote (variance, skew, kurtosis, and entropy). The nature of the data itself is not important for our purposes; we are merely interested in the distribution of the four continuous variables over the binary class variable. In a practical setting, the goal of this quick analysis would be to give us a hint as to which variables are most important to explaining the classification of each bank note.</p>
<p>In this first chunk, read in data, give each column a name, and present basic boxplots</p>
<div class="highlight"><pre><span></span><span class="kn">library</span><span class="p">(</span>GGally<span class="p">)</span>

<span class="c1"># name attributes</span>
<span class="kp">colnames</span><span class="p">(</span>note<span class="p">)</span> <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">(</span><span class="s">&quot;var&quot;</span><span class="p">,</span><span class="s">&quot;skew&quot;</span><span class="p">,</span><span class="s">&quot;kurt&quot;</span><span class="p">,</span><span class="s">&quot;entropy&quot;</span><span class="p">,</span><span class="s">&quot;class&quot;</span><span class="p">)</span>

<span class="c1"># basic boxplot of variance</span>
boxplot<span class="p">(</span>note<span class="o">$</span>var<span class="p">,</span> data<span class="o">=</span>note<span class="p">,</span> main<span class="o">=</span><span class="s">&quot;Variance&quot;</span><span class="p">,</span> bg<span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">)</span>
</pre></div>


<p><img src="./figure/ggpairs-note_prep-1.png" title="plot of chunk note_prep" alt="plot of chunk note_prep" style="display: block; margin: auto;" /></p>
<div class="highlight"><pre><span></span><span class="c1"># boxplot of variance distributed over each class</span>
boxplot<span class="p">(</span>var<span class="o">~</span><span class="kp">class</span><span class="p">,</span> data<span class="o">=</span>note<span class="p">,</span> main<span class="o">=</span><span class="s">&quot;Variance over Class&quot;</span><span class="p">)</span>
</pre></div>


<p><img src="./figure/ggpairs-note_prep-2.png" title="plot of chunk note_prep" alt="plot of chunk note_prep" style="display: block; margin: auto;" /></p>
<p>While this graph certainly gets the job done, it is not aesthetically pleasing. For better looking graphs, let use <code>ggplot2</code>. We would also like to see each variable distributed over class. So to present the graphs side by side, we will use the <code>grid.arrage</code> function from <code>gridExtra</code> package.</p>
<div class="highlight"><pre><span></span><span class="c1"># load libraries</span>
<span class="kn">library</span><span class="p">(</span>ggplot2<span class="p">)</span>
<span class="kn">library</span><span class="p">(</span>gridExtra<span class="p">)</span>

<span class="c1"># boxplots</span>
box_var<span class="o">&lt;-</span>ggplot<span class="p">(</span>note<span class="p">,</span> aes<span class="p">(</span><span class="kp">factor</span><span class="p">(</span><span class="kp">class</span><span class="p">),</span>var<span class="p">))</span><span class="o">+</span>geom_boxplot<span class="p">(</span>aes<span class="p">(</span>fill<span class="o">=</span><span class="kp">factor</span><span class="p">(</span><span class="kp">class</span><span class="p">)))</span>

box_skew<span class="o">&lt;-</span>ggplot<span class="p">(</span>note<span class="p">,</span> aes<span class="p">(</span><span class="kp">factor</span><span class="p">(</span><span class="kp">class</span><span class="p">),</span>skew<span class="p">))</span><span class="o">+</span>geom_boxplot<span class="p">(</span>aes<span class="p">(</span>fill<span class="o">=</span><span class="kp">factor</span><span class="p">(</span><span class="kp">class</span><span class="p">)))</span>

box_kurt<span class="o">&lt;-</span>ggplot<span class="p">(</span>note<span class="p">,</span> aes<span class="p">(</span><span class="kp">factor</span><span class="p">(</span><span class="kp">class</span><span class="p">),</span>kurt<span class="p">))</span><span class="o">+</span>geom_boxplot<span class="p">(</span>aes<span class="p">(</span>fill<span class="o">=</span><span class="kp">factor</span><span class="p">(</span><span class="kp">class</span><span class="p">)))</span>

box_entropy<span class="o">&lt;-</span>ggplot<span class="p">(</span>note<span class="p">,</span> aes<span class="p">(</span><span class="kp">factor</span><span class="p">(</span><span class="kp">class</span><span class="p">),</span>entropy<span class="p">))</span><span class="o">+</span>geom_boxplot<span class="p">(</span>aes<span class="p">(</span>fill<span class="o">=</span><span class="kp">factor</span><span class="p">(</span><span class="kp">class</span><span class="p">)))</span>

<span class="c1"># arrange in a 2x2 grid</span>
grid.arrange<span class="p">(</span>box_var<span class="p">,</span> box_skew<span class="p">,</span> box_kurt<span class="p">,</span> box_entropy<span class="p">,</span> ncol<span class="o">=</span><span class="m">2</span><span class="p">,</span> nrow<span class="o">=</span><span class="m">2</span><span class="p">)</span>
</pre></div>


<p><img src="./figure/ggpairs-note_ggplot-1.png" title="plot of chunk note_ggplot" alt="plot of chunk note_ggplot" style="display: block; margin: auto;" /></p>
<p>This looks much better and we can quickly see that the variable <code>var</code> provides the most variation over the two classes. For even better looking plots we can change the labeling:</p>
<div class="highlight"><pre><span></span><span class="c1"># boxplots</span>
box_var<span class="o">&lt;-</span>ggplot<span class="p">(</span>note<span class="p">,</span> aes<span class="p">(</span><span class="kp">factor</span><span class="p">(</span><span class="kp">class</span><span class="p">),</span>var<span class="p">))</span><span class="o">+</span>geom_boxplot<span class="p">(</span>aes<span class="p">(</span>fill<span class="o">=</span><span class="kp">factor</span><span class="p">(</span><span class="kp">class</span><span class="p">)))</span><span class="o">+</span> labs<span class="p">(</span>x<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span>y<span class="o">=</span><span class="s">&quot;Variance&quot;</span><span class="p">)</span> <span class="o">+</span> theme<span class="p">(</span>legend.position<span class="o">=</span><span class="s">&quot;none&quot;</span><span class="p">)</span><span class="o">+</span>theme<span class="p">(</span>plot.background <span class="o">=</span> element_rect<span class="p">(</span>fill <span class="o">=</span> <span class="s">&#39;#ECF0F1&#39;</span><span class="p">,</span> colour <span class="o">=</span> <span class="s">&#39;#ECF0F1&#39;</span><span class="p">))</span>

box_skew<span class="o">&lt;-</span>ggplot<span class="p">(</span>note<span class="p">,</span> aes<span class="p">(</span><span class="kp">factor</span><span class="p">(</span><span class="kp">class</span><span class="p">),</span>skew<span class="p">))</span><span class="o">+</span>geom_boxplot<span class="p">(</span>aes<span class="p">(</span>fill<span class="o">=</span><span class="kp">factor</span><span class="p">(</span><span class="kp">class</span><span class="p">)))</span><span class="o">+</span> labs<span class="p">(</span>x<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span>y<span class="o">=</span><span class="s">&quot;Skewness&quot;</span><span class="p">)</span> <span class="o">+</span> theme<span class="p">(</span>legend.position<span class="o">=</span><span class="s">&quot;none&quot;</span><span class="p">)</span><span class="o">+</span>theme<span class="p">(</span>plot.background <span class="o">=</span> element_rect<span class="p">(</span>fill <span class="o">=</span> <span class="s">&#39;#ECF0F1&#39;</span><span class="p">,</span> colour <span class="o">=</span> <span class="s">&#39;#ECF0F1&#39;</span><span class="p">))</span>

box_kurt<span class="o">&lt;-</span>ggplot<span class="p">(</span>note<span class="p">,</span> aes<span class="p">(</span><span class="kp">factor</span><span class="p">(</span><span class="kp">class</span><span class="p">),</span>kurt<span class="p">))</span><span class="o">+</span>geom_boxplot<span class="p">(</span>aes<span class="p">(</span>fill<span class="o">=</span><span class="kp">factor</span><span class="p">(</span><span class="kp">class</span><span class="p">)))</span><span class="o">+</span> labs<span class="p">(</span>x<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span>y<span class="o">=</span><span class="s">&quot;Kurtosis&quot;</span><span class="p">)</span> <span class="o">+</span> theme<span class="p">(</span>legend.position<span class="o">=</span><span class="s">&quot;none&quot;</span><span class="p">)</span><span class="o">+</span>theme<span class="p">(</span>plot.background <span class="o">=</span> element_rect<span class="p">(</span>fill <span class="o">=</span> <span class="s">&#39;#ECF0F1&#39;</span><span class="p">,</span> colour <span class="o">=</span> <span class="s">&#39;#ECF0F1&#39;</span><span class="p">))</span>

box_entropy<span class="o">&lt;-</span>ggplot<span class="p">(</span>note<span class="p">,</span> aes<span class="p">(</span><span class="kp">factor</span><span class="p">(</span><span class="kp">class</span><span class="p">),</span>entropy<span class="p">))</span><span class="o">+</span>geom_boxplot<span class="p">(</span>aes<span class="p">(</span>fill<span class="o">=</span><span class="kp">factor</span><span class="p">(</span><span class="kp">class</span><span class="p">)))</span><span class="o">+</span> labs<span class="p">(</span>x<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span>y<span class="o">=</span><span class="s">&quot;Entropy&quot;</span><span class="p">)</span> <span class="o">+</span> theme<span class="p">(</span>legend.position<span class="o">=</span><span class="s">&quot;none&quot;</span><span class="p">)</span><span class="o">+</span>theme<span class="p">(</span>plot.background <span class="o">=</span> element_rect<span class="p">(</span>fill <span class="o">=</span> <span class="s">&#39;#ECF0F1&#39;</span><span class="p">,</span> colour <span class="o">=</span> <span class="s">&#39;#ECF0F1&#39;</span><span class="p">))</span>

<span class="c1"># arrange in a 2x2 grid</span>
grid.arrange<span class="p">(</span>box_var<span class="p">,</span> box_skew<span class="p">,</span> box_kurt<span class="p">,</span> box_entropy<span class="p">,</span> ncol<span class="o">=</span><span class="m">2</span><span class="p">,</span> nrow<span class="o">=</span><span class="m">2</span><span class="p">)</span>
</pre></div>


<p><img src="./figure/ggpairs-note_ggplot2-1.png" title="plot of chunk note_ggplot2" alt="plot of chunk note_ggplot2" style="display: block; margin: auto;" /></p>
<p>This looks good, however, but not super great. The code is repetitive and the layout is not really that pleasing. We could try to add a shared legend, play with the labeling some more, and try to bum some code. Or we could just use <code>ggpair</code>:</p>
<div class="highlight"><pre><span></span><span class="c1"># set color theme so we don&#39;t have to repeat the theme background color code so much</span>
theme_set<span class="p">(</span>theme_grey<span class="p">()</span><span class="o">+</span>theme<span class="p">(</span>legend.position<span class="o">=</span><span class="s">&quot;none&quot;</span><span class="p">)</span><span class="o">+</span>theme<span class="p">(</span>plot.background <span class="o">=</span> element_rect<span class="p">(</span>fill <span class="o">=</span> <span class="s">&#39;#ECF0F1&#39;</span><span class="p">,</span> colour <span class="o">=</span> <span class="s">&#39;#ECF0F1&#39;</span><span class="p">)))</span>

<span class="c1"># variance of class</span>
ggpairs<span class="p">(</span>data<span class="o">=</span>note<span class="p">,</span> columns<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">5</span><span class="p">))</span>
</pre></div>


<p><img src="./figure/ggpairs-note_ggpairs1-1.png" title="plot of chunk note_ggpairs1" alt="plot of chunk note_ggpairs1" style="display: block; margin: auto;" /></p>
<p>This above chart is nice diagnostic of each variable by itself and of their relationship to each other. You'll notice, however, that it is treating class as a continuous variable when really it should be a factor (we manually specified this in the ggplot code above). Lets convert to a factor and then try again for each variable.</p>
<div class="highlight"><pre><span></span><span class="c1"># convert class to a factor</span>
note<span class="o">$</span>class <span class="o">&lt;-</span> <span class="kp">as.factor</span><span class="p">(</span>note<span class="o">$</span><span class="kp">class</span><span class="p">)</span>

<span class="c1"># ggpairs</span>
ggpairs<span class="p">(</span>data<span class="o">=</span>note<span class="p">,</span> columns<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">5</span><span class="p">))</span>
</pre></div>


<p><img src="./figure/ggpairs-note_ggpairs2-1.png" title="plot of chunk note_ggpairs2" alt="plot of chunk note_ggpairs2" style="display: block; margin: auto;" /></p>
<div class="highlight"><pre><span></span>ggpairs<span class="p">(</span>data<span class="o">=</span>note<span class="p">,</span> columns<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">5</span><span class="p">))</span>
</pre></div>


<p><img src="./figure/ggpairs-note_ggpairs2-2.png" title="plot of chunk note_ggpairs2" alt="plot of chunk note_ggpairs2" style="display: block; margin: auto;" /></p>
<div class="highlight"><pre><span></span>ggpairs<span class="p">(</span>data<span class="o">=</span>note<span class="p">,</span> columns<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="m">5</span><span class="p">))</span>
</pre></div>


<p><img src="./figure/ggpairs-note_ggpairs2-3.png" title="plot of chunk note_ggpairs2" alt="plot of chunk note_ggpairs2" style="display: block; margin: auto;" /></p>
<div class="highlight"><pre><span></span>ggpairs<span class="p">(</span>data<span class="o">=</span>note<span class="p">,</span> columns<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">4</span><span class="p">,</span><span class="m">5</span><span class="p">))</span>
</pre></div>


<p><img src="./figure/ggpairs-note_ggpairs2-4.png" title="plot of chunk note_ggpairs2" alt="plot of chunk note_ggpairs2" style="display: block; margin: auto;" /></p>
<p>Now this looks great. Not only do we have the boxplots from above, but we also get to see the distributions of each variable by itself. And finally, if want to see <code>ggpairs</code> for all combinations of data, we just simply call it over the entire dataframe.</p>
<div class="highlight"><pre><span></span><span class="c1"># combine all into one ggpairs call</span>
ggpairs<span class="p">(</span>data<span class="o">=</span>note<span class="p">,</span> columns<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">5</span><span class="p">))</span>
</pre></div>


<p><img src="./figure/ggpairs-note_ggpairs3-1.png" title="plot of chunk note_ggpairs3" alt="plot of chunk note_ggpairs3" style="display: block; margin: auto;" /></p>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="./tag/r.html">r</a>
      <a href="./tag/exploratory-analysis.html">exploratory analysis</a>
    </p>
  </div>




</article>

    <footer>
<p>&copy; kyle thomas </p>
<p>    Powered by <a href="http://getpelican.com" target="_blank">Pelican</a> - <a href="https://github.com/alexandrevicenzi/flex" target="_blank">Flex</a> theme by <a href="http://alexandrevicenzi.com" target="_blank">Alexandre Vicenzi</a>
</p>    </footer>
  </main>





<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " cmd+build ",
  "url" : ".",
  "image": "",
  "description": ""
}
</script>
</body>
</html>