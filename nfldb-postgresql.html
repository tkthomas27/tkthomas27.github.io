<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title></title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-1.1/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-1.1/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}

.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = false;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="notebook_archive.html">
    <span class="fa fa-book"></span>
     
    Notebooks
  </a>
</li>
<li>
  <a href="log_archive.html">
    <span class="ion ion-clipboard"></span>
     
    Logs
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/tkthomas27">
    <span class="ion ion-social-github"></span>
     
    Github
  </a>
</li>
<li>
  <a href="https://twitter.com/tkylethomas27">
    <span class="ion ion-social-twitter"></span>
     
    Twitter
  </a>
</li>
<li>
  <a href="https://www.linkedin.com/in/timothykylethomas/">
    <span class="ion ion-social-linkedin"></span>
     
    LinkedIn
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">




</div>


<div id="initialization" class="section level1">
<h1><span class="header-section-number">1</span> Initialization</h1>
<p>Ever wonder who had the heaviest offensive line in the NFL? Or which team had the most penalties over the past few seasons? What if I told you that you didn’t need to be an ESPN statistician to figure this out? What if—after a minimal investment in setup—you could easily query NFL data and start building your own predictive models?</p>
<p>Well I’m here to tell you that it is actually pretty easy to do—even for non-coders. After a few days of tinkering I was able to establish an easy to use, mostly accurate pipeline for analyzing NFL data. This post is directed towards people of all skill levels, but particularly novices.</p>
<p>What you’ll need: * Willingness to learn new things and to grind out the many small issues that inevitably arise * A computer running MacOS (or any other Unix based system) * Python * nfldb * PostgreSQL</p>
<div id="python" class="section level2">
<h2><span class="header-section-number">1.1</span> Python</h2>
<p>Python is a powerful yet easy to use programming language capable of processing and analyzing data. It is widely used throughout the industry and is pre-installed on MacOS (although we will be using Python 3). There are about a million different tutorials you can use to become more familiar with how Python is used; I recommend <a href="https://learnpythonthehardway.org">Python the Hard Way</a>. Interactive tutorials are available at <a href="https://www.datacamp.com/learn-python-with-anaconda?utm_source=Anaconda_download&amp;utm_campaign=datacamp_training&amp;utm_medium=banner">Datacamp</a>.</p>
<p>Although Python is pre-installed on MacOS, I recommend installing it via <a href="https://www.anaconda.com">Anaconda</a>. Anaconda is a convenient bundle of Python and many of the additional libraries necessary to do data analysis. I will be using Python 3, so be sure to download that version (note that the download may take a while).</p>
<p>Python code can be edited and run either by the command line or an interactive development environment (IDE). I highly recommend using an IDE as they are significanlty more useful in working with code. Anaconda comes with <strong>Jupyter</strong> (what I am using to write and publish this article). Jupyter uses your web browser to allow you to edit and execute your code in chunks. However, I use <a href="https://pythonhosted.org/spyder/">Spyder</a> to develop my code because it allows me to see variables, dataframes, arrays, etc. that I have generated. Once installed type either <code>jupyter notebook</code> or <code>spyder</code> in terminal and a new session will begin.</p>
</div>
<div id="sql" class="section level2">
<h2><span class="header-section-number">1.2</span> SQL</h2>
<p>SQL (structured query language) is an ancient method of querying databases. It’s super easy to figure out once you see it in practice. The bulk of this post will be a series of queries designed to illustrate the basic functionality of SQL.</p>
</div>
<div id="postgresql" class="section level2">
<h2><span class="header-section-number">1.3</span> PostgreSQL</h2>
<p>PostgreSQL is a database management system that allows you to store and query your data using SQL. There are several ways to install PostgreSQL. You can either use the <a href="https://brew.sh">Homebrew</a> method or <a href="http://postgresapp.com">Postgres App</a>. The Postgres App is the easiest option for MacOS. I am currently using <a href="https://eggerapps.at/postico/">Postico</a> to view my data and test out different queries.</p>
</div>
<div id="nfldb" class="section level2">
<h2><span class="header-section-number">1.4</span> NFLDB</h2>
<p>Once you have PostgreSQL setup, you are ready to get the NFL data. <a href="https://github.com/BurntSushi/nfldb">nfldb</a> is a module designed to scrape data from the NFL website and put it into a SQL table. The <a href="https://github.com/BurntSushi/nfldb/wiki/Installation">instructions</a> for installing nfldb are overly complicated, so here is a much more simple guide. Basically, all you need to do is create a blank Postgres datbase, run the SQL file, and then make a minor configuration change.</p>
<p>The following is a list of instruction you will need to type into your command line. On Mac, simply open terminal and make sure you are in your <code>~</code> (aka your root directory). If you are unsure what the name of your <code>~</code> directory is, open finder and look at the name next to the house icon. Your terminal should open to <code>~</code> by default.</p>
<ol style="list-style-type: decimal">
<li>Open terminal and type <code>psql</code> to launch PostgreSQL</li>
<li>Type <code>CREATE DATABASE nfldb;</code>, then <code>\connect nfldb</code>, and then <code>CREATEUSER nfldb;</code></li>
<li>Download the <a href="http://burntsushi.net/stuff/nfldb/nfldb.sql.zip">SQL file</a> and unzip it to your <code>~</code> directory</li>
<li>Make sure terminal is in your <code>~</code> directory and type <code>psql -U nfldb nfldb &lt; nfldb.sql</code>. This should create an empty NFL database in PostgreSQL</li>
<li>Now type <code>pip install nfldb</code> to install the Python code necessary to fill in the NFL database</li>
<li>Now type <code>locate config.ini.sample</code>. It should return a path like <code>/usr/local/share/nfldb/config.ini.sample</code>. Highlight this path and copy it</li>
<li>Type <code>mkdir -p $HOME/.config/nfldb</code> and press enter</li>
<li>Type <code>cp &lt;paste the path from step 6 here&gt; $HOME/.config/nfldb/config.ini</code></li>
</ol>
<p>And that’s it! Everything should work now. The <a href="https://github.com/BurntSushi/nfldb/wiki/Installation">installation guide</a> has a few exercises to make sure everything is up and running.</p>
</div>
</div>
<div id="querying-the-data" class="section level1">
<h1><span class="header-section-number">2</span> Querying the Data</h1>
<p>First thing we need to do is import the libraries we will be using. <strong>Pandas</strong> is an incredibly useful library for manipulating data. Here we will use the <code>pandas.read_sql</code> method to query the data and display the results in a nice table format. We will also be using <strong>psycopg2</strong> to create a connection to the PostgreSQL database.</p>
<p>If for some reason neither pandas nor psycog2 is not installed, use <code>pip &lt;package name&gt;</code> or <code>conda install &lt;package name&gt;</code> to perform the installation.</p>
<pre class="python"><code># import pandas
import pandas as pd

# import psycopg2
import psycopg2

# provide your credentials; yours should look the same except with you user name
conn=psycopg2.connect(&quot;dbname=&#39;nfldb&#39; user=&#39;kthomas1&#39; host=&#39;localhost&#39; password=&#39;&#39; port=5432&quot;)

# create the connection
cur=conn.cursor()</code></pre>
<div id="select-from-where-limit" class="section level2">
<h2><span class="header-section-number">2.1</span> SELECT, FROM, WHERE, LIMIT</h2>
<p>Here we will perform the most basic query. Let’s look at the first 10 players for the Carolina Panthers listed in the <code>player</code> table. First we <code>SELECT</code> the variables we want <code>FROM</code> the <code>player</code> table. We use the <code>WHERE</code> command to filter to just the Panthers. Finally, we only want the first 10 observations, so type <code>LIMIT 10</code> at the end.</p>
<pre class="python"><code>pd.read_sql(&quot;&quot;&quot;SELECT full_name, position, uniform_number, height, weight, college 
FROM player 
WHERE team=&#39;CAR&#39; 
LIMIT 10&quot;&quot;&quot;,con=conn)</code></pre>
<div>
<table border="1" class="dataframe">
<thead>
<pre><code>&lt;tr style=&quot;text-align: right;&quot;&gt;
  &lt;th&gt;&lt;/th&gt;
  &lt;th&gt;full_name&lt;/th&gt;
  &lt;th&gt;position&lt;/th&gt;
  &lt;th&gt;uniform_number&lt;/th&gt;
  &lt;th&gt;height&lt;/th&gt;
  &lt;th&gt;weight&lt;/th&gt;
  &lt;th&gt;college&lt;/th&gt;
&lt;/tr&gt;</code></pre>
</thead>
<tbody>
<pre><code>&lt;tr&gt;
  &lt;th&gt;0&lt;/th&gt;
  &lt;td&gt;Robert McClain&lt;/td&gt;
  &lt;td&gt;DB&lt;/td&gt;
  &lt;td&gt;27&lt;/td&gt;
  &lt;td&gt;69&lt;/td&gt;
  &lt;td&gt;195&lt;/td&gt;
  &lt;td&gt;Connecticut&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;1&lt;/th&gt;
  &lt;td&gt;Daryl Williams&lt;/td&gt;
  &lt;td&gt;OT&lt;/td&gt;
  &lt;td&gt;60&lt;/td&gt;
  &lt;td&gt;78&lt;/td&gt;
  &lt;td&gt;335&lt;/td&gt;
  &lt;td&gt;Oklahoma&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;2&lt;/th&gt;
  &lt;td&gt;Jonathan Stewart&lt;/td&gt;
  &lt;td&gt;RB&lt;/td&gt;
  &lt;td&gt;28&lt;/td&gt;
  &lt;td&gt;70&lt;/td&gt;
  &lt;td&gt;240&lt;/td&gt;
  &lt;td&gt;Oregon&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;3&lt;/th&gt;
  &lt;td&gt;Brenton Bersin&lt;/td&gt;
  &lt;td&gt;WR&lt;/td&gt;
  &lt;td&gt;11&lt;/td&gt;
  &lt;td&gt;75&lt;/td&gt;
  &lt;td&gt;210&lt;/td&gt;
  &lt;td&gt;Wofford&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;4&lt;/th&gt;
  &lt;td&gt;Ted Ginn&lt;/td&gt;
  &lt;td&gt;WR&lt;/td&gt;
  &lt;td&gt;19&lt;/td&gt;
  &lt;td&gt;71&lt;/td&gt;
  &lt;td&gt;180&lt;/td&gt;
  &lt;td&gt;Ohio State&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;5&lt;/th&gt;
  &lt;td&gt;James Bradberry&lt;/td&gt;
  &lt;td&gt;CB&lt;/td&gt;
  &lt;td&gt;24&lt;/td&gt;
  &lt;td&gt;73&lt;/td&gt;
  &lt;td&gt;210&lt;/td&gt;
  &lt;td&gt;Samford&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;6&lt;/th&gt;
  &lt;td&gt;Daryl Worley&lt;/td&gt;
  &lt;td&gt;CB&lt;/td&gt;
  &lt;td&gt;26&lt;/td&gt;
  &lt;td&gt;73&lt;/td&gt;
  &lt;td&gt;205&lt;/td&gt;
  &lt;td&gt;West Virginia&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;7&lt;/th&gt;
  &lt;td&gt;Ryan Kalil&lt;/td&gt;
  &lt;td&gt;C&lt;/td&gt;
  &lt;td&gt;67&lt;/td&gt;
  &lt;td&gt;74&lt;/td&gt;
  &lt;td&gt;300&lt;/td&gt;
  &lt;td&gt;USC&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;8&lt;/th&gt;
  &lt;td&gt;Dean Marlowe&lt;/td&gt;
  &lt;td&gt;FS&lt;/td&gt;
  &lt;td&gt;29&lt;/td&gt;
  &lt;td&gt;73&lt;/td&gt;
  &lt;td&gt;210&lt;/td&gt;
  &lt;td&gt;James Madison&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;9&lt;/th&gt;
  &lt;td&gt;Tyler Larsen&lt;/td&gt;
  &lt;td&gt;OG&lt;/td&gt;
  &lt;td&gt;69&lt;/td&gt;
  &lt;td&gt;76&lt;/td&gt;
  &lt;td&gt;335&lt;/td&gt;
  &lt;td&gt;Utah&lt;/td&gt;
&lt;/tr&gt;</code></pre>
</tbody>
</table>
</div>
<p>And here we see the first limitation of the NFLDB dataset—it is outdated. Several of these players are not on the Carolina roster as of 2017. I have tried updating the database but have been unsuccessful. I will update this post if I can determine a solution.</p>
<p>One of the nice things about Jupyer + pandas are that these dataframes have sortable columns.</p>
</div>
<div id="count-avg-sum-max-min" class="section level2">
<h2><span class="header-section-number">2.2</span> COUNT, AVG, SUM, MAX, MIN</h2>
<p>SQL allows us to count the number of entries that meet a certain criteria. We can also take the sum or average or find the max/min of a column.</p>
<pre class="python"><code># total number of posessions by Carolina from 2009-2016
cur.execute(&quot;&quot;&quot;SELECT COUNT(pos_team)
FROM play
WHERE pos_team=&#39;CAR&#39;&quot;&quot;&quot;)

pos,=cur.fetchall()
print(&quot;Total Number of Possessions by Carolin from 2009-2016: {:,}&quot;.format(int(pos[0])))</code></pre>
<pre><code>Total Number of Possessions by Carolin from 2009-2016: 13,532</code></pre>
<pre class="python"><code># average penalty yards for buffalo
cur.execute(&quot;&quot;&quot;SELECT AVG(penalty_yds)
FROM play
WHERE pos_team=&#39;BUF&#39; AND penalty_yds!=0&quot;&quot;&quot;)

penalty,=cur.fetchall()
print(&quot;Average Penalty Yards for Buffalo from 2009-2016: {:.2f}&quot;.format(float(penalty[0])))</code></pre>
<pre><code>Average Penalty Yards for Buffalo from 2009-2016: 8.64</code></pre>
<pre class="python"><code># total weight of offensive line for oakland
cur.execute(&quot;&quot;&quot;SELECT sum(weight)
FROM player
WHERE team=&#39;OAK&#39; AND (position=&#39;OL&#39; OR position=&#39;OG&#39; OR position=&#39;OT&#39; OR position=&#39;C&#39;)&quot;&quot;&quot;)

weight,=cur.fetchall()
print(&quot;Total Weight of the Oakland offensive line: {:,} lbs&quot;.format(int(weight[0])))</code></pre>
<pre><code>Total Weight of the Oakland offensive line: 1,611 lbs</code></pre>
<pre class="python"><code># the shortest player in the database
cur.execute(&quot;&quot;&quot;SELECT min(height)
FROM player
WHERE status=&#39;Active&#39;&quot;&quot;&quot;)

height,=cur.fetchall()
height_feet = float(height[0])/12
print(&quot;Height of the shortest player in the database: {:.1f} ft&quot;.format(float(height_feet)))</code></pre>
<pre><code>Height of the shortest player in the database: 5.5 ft</code></pre>
</div>
<div id="order-by" class="section level2">
<h2><span class="header-section-number">2.3</span> ORDER BY</h2>
<p>If we want to sort our queries we can use ORDER BY. Here we get a list of the 10 heaviest players in the database by using a descending order by on weight.</p>
<pre class="python"><code>pd.read_sql(&quot;&quot;&quot;select full_name, position, team, weight
from player
where status=&#39;Active&#39;
order by weight DESC
limit 10&quot;&quot;&quot;,con=conn)</code></pre>
<div>
<table border="1" class="dataframe">
<thead>
<pre><code>&lt;tr style=&quot;text-align: right;&quot;&gt;
  &lt;th&gt;&lt;/th&gt;
  &lt;th&gt;full_name&lt;/th&gt;
  &lt;th&gt;position&lt;/th&gt;
  &lt;th&gt;team&lt;/th&gt;
  &lt;th&gt;weight&lt;/th&gt;
&lt;/tr&gt;</code></pre>
</thead>
<tbody>
<pre><code>&lt;tr&gt;
  &lt;th&gt;0&lt;/th&gt;
  &lt;td&gt;John Jenkins&lt;/td&gt;
  &lt;td&gt;DT&lt;/td&gt;
  &lt;td&gt;NO&lt;/td&gt;
  &lt;td&gt;359&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;1&lt;/th&gt;
  &lt;td&gt;Denzelle Good&lt;/td&gt;
  &lt;td&gt;OT&lt;/td&gt;
  &lt;td&gt;IND&lt;/td&gt;
  &lt;td&gt;355&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;2&lt;/th&gt;
  &lt;td&gt;Trent Brown&lt;/td&gt;
  &lt;td&gt;OT&lt;/td&gt;
  &lt;td&gt;SF&lt;/td&gt;
  &lt;td&gt;355&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;3&lt;/th&gt;
  &lt;td&gt;Dan McCullers-Sanders&lt;/td&gt;
  &lt;td&gt;NT&lt;/td&gt;
  &lt;td&gt;PIT&lt;/td&gt;
  &lt;td&gt;352&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;4&lt;/th&gt;
  &lt;td&gt;Alan Branch&lt;/td&gt;
  &lt;td&gt;DT&lt;/td&gt;
  &lt;td&gt;NE&lt;/td&gt;
  &lt;td&gt;350&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;5&lt;/th&gt;
  &lt;td&gt;Damon Harrison&lt;/td&gt;
  &lt;td&gt;DT&lt;/td&gt;
  &lt;td&gt;NYG&lt;/td&gt;
  &lt;td&gt;350&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;6&lt;/th&gt;
  &lt;td&gt;Dontari Poe&lt;/td&gt;
  &lt;td&gt;NT&lt;/td&gt;
  &lt;td&gt;KC&lt;/td&gt;
  &lt;td&gt;346&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;7&lt;/th&gt;
  &lt;td&gt;Cordy Glenn&lt;/td&gt;
  &lt;td&gt;T&lt;/td&gt;
  &lt;td&gt;BUF&lt;/td&gt;
  &lt;td&gt;345&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;8&lt;/th&gt;
  &lt;td&gt;Haloti Ngata&lt;/td&gt;
  &lt;td&gt;DT&lt;/td&gt;
  &lt;td&gt;DET&lt;/td&gt;
  &lt;td&gt;345&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;9&lt;/th&gt;
  &lt;td&gt;Paul Soliai&lt;/td&gt;
  &lt;td&gt;DT&lt;/td&gt;
  &lt;td&gt;CAR&lt;/td&gt;
  &lt;td&gt;345&lt;/td&gt;
&lt;/tr&gt;</code></pre>
</tbody>
</table>
</div>
</div>
<div id="distinct-group-by-char_length" class="section level2">
<h2><span class="header-section-number">2.4</span> DISTINCT, GROUP BY, CHAR_LENGTH</h2>
<p>When exploring a database it is often useful to see the unique values in a column. SQL allows us to do that by using the DISTINCT command.</p>
<pre class="python"><code># all the positions from the player db
pd.read_sql(&quot;&quot;&quot;select DISTINCT position
from player&quot;&quot;&quot;,con=conn)</code></pre>
<div>
<table border="1" class="dataframe">
<thead>
<pre><code>&lt;tr style=&quot;text-align: right;&quot;&gt;
  &lt;th&gt;&lt;/th&gt;
  &lt;th&gt;position&lt;/th&gt;
&lt;/tr&gt;</code></pre>
</thead>
<tbody>
<pre><code>&lt;tr&gt;
  &lt;th&gt;0&lt;/th&gt;
  &lt;td&gt;RB&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;1&lt;/th&gt;
  &lt;td&gt;WR&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;2&lt;/th&gt;
  &lt;td&gt;G&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;3&lt;/th&gt;
  &lt;td&gt;SS&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;4&lt;/th&gt;
  &lt;td&gt;TE&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;5&lt;/th&gt;
  &lt;td&gt;DE&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;6&lt;/th&gt;
  &lt;td&gt;MLB&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;7&lt;/th&gt;
  &lt;td&gt;OG&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;8&lt;/th&gt;
  &lt;td&gt;NT&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;9&lt;/th&gt;
  &lt;td&gt;DB&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;10&lt;/th&gt;
  &lt;td&gt;LB&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;11&lt;/th&gt;
  &lt;td&gt;SAF&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;12&lt;/th&gt;
  &lt;td&gt;OT&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;13&lt;/th&gt;
  &lt;td&gt;UNK&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;14&lt;/th&gt;
  &lt;td&gt;K&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;15&lt;/th&gt;
  &lt;td&gt;FB&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;16&lt;/th&gt;
  &lt;td&gt;T&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;17&lt;/th&gt;
  &lt;td&gt;OL&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;18&lt;/th&gt;
  &lt;td&gt;ILB&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;19&lt;/th&gt;
  &lt;td&gt;QB&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;20&lt;/th&gt;
  &lt;td&gt;DT&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;21&lt;/th&gt;
  &lt;td&gt;LS&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;22&lt;/th&gt;
  &lt;td&gt;P&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;23&lt;/th&gt;
  &lt;td&gt;OLB&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;24&lt;/th&gt;
  &lt;td&gt;DL&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;25&lt;/th&gt;
  &lt;td&gt;C&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;26&lt;/th&gt;
  &lt;td&gt;FS&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;27&lt;/th&gt;
  &lt;td&gt;CB&lt;/td&gt;
&lt;/tr&gt;</code></pre>
</tbody>
</table>
</div>
<p>To figure out who had the most penalty yards from 2009-2016, we’ll need to combine SUM, GROUP BY, and then ORDER BY. The query below essentially sums every entry in the <code>penalty_yds</code> column for each team. We also use the AS operator to rename the <code>sum(penalty_yds)</code>.</p>
<pre class="python"><code># who had the most penalty yards for 2009-2016?
pd.read_sql(&quot;&quot;&quot;select pos_team, sum(penalty_yds) as total_penalty_yards
from play
group by pos_team
order by sum(penalty_yds) DESC&quot;&quot;&quot;,con=conn)</code></pre>
<div>
<table border="1" class="dataframe">
<thead>
<pre><code>&lt;tr style=&quot;text-align: right;&quot;&gt;
  &lt;th&gt;&lt;/th&gt;
  &lt;th&gt;pos_team&lt;/th&gt;
  &lt;th&gt;total_penalty_yards&lt;/th&gt;
&lt;/tr&gt;</code></pre>
</thead>
<tbody>
<pre><code>&lt;tr&gt;
  &lt;th&gt;0&lt;/th&gt;
  &lt;td&gt;GB&lt;/td&gt;
  &lt;td&gt;10443&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;1&lt;/th&gt;
  &lt;td&gt;BAL&lt;/td&gt;
  &lt;td&gt;10375&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;2&lt;/th&gt;
  &lt;td&gt;SEA&lt;/td&gt;
  &lt;td&gt;10017&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;3&lt;/th&gt;
  &lt;td&gt;OAK&lt;/td&gt;
  &lt;td&gt;9909&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;4&lt;/th&gt;
  &lt;td&gt;TB&lt;/td&gt;
  &lt;td&gt;9849&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;5&lt;/th&gt;
  &lt;td&gt;PIT&lt;/td&gt;
  &lt;td&gt;9691&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;6&lt;/th&gt;
  &lt;td&gt;DEN&lt;/td&gt;
  &lt;td&gt;9577&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;7&lt;/th&gt;
  &lt;td&gt;IND&lt;/td&gt;
  &lt;td&gt;9570&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;8&lt;/th&gt;
  &lt;td&gt;ARI&lt;/td&gt;
  &lt;td&gt;9562&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;9&lt;/th&gt;
  &lt;td&gt;PHI&lt;/td&gt;
  &lt;td&gt;9506&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;10&lt;/th&gt;
  &lt;td&gt;CIN&lt;/td&gt;
  &lt;td&gt;9469&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;11&lt;/th&gt;
  &lt;td&gt;NE&lt;/td&gt;
  &lt;td&gt;9414&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;12&lt;/th&gt;
  &lt;td&gt;NO&lt;/td&gt;
  &lt;td&gt;9359&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;13&lt;/th&gt;
  &lt;td&gt;WAS&lt;/td&gt;
  &lt;td&gt;9240&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;14&lt;/th&gt;
  &lt;td&gt;NYG&lt;/td&gt;
  &lt;td&gt;9109&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;15&lt;/th&gt;
  &lt;td&gt;BUF&lt;/td&gt;
  &lt;td&gt;9083&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;16&lt;/th&gt;
  &lt;td&gt;TEN&lt;/td&gt;
  &lt;td&gt;8999&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;17&lt;/th&gt;
  &lt;td&gt;ATL&lt;/td&gt;
  &lt;td&gt;8993&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;18&lt;/th&gt;
  &lt;td&gt;DAL&lt;/td&gt;
  &lt;td&gt;8915&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;19&lt;/th&gt;
  &lt;td&gt;DET&lt;/td&gt;
  &lt;td&gt;8913&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;20&lt;/th&gt;
  &lt;td&gt;SF&lt;/td&gt;
  &lt;td&gt;8802&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;21&lt;/th&gt;
  &lt;td&gt;CHI&lt;/td&gt;
  &lt;td&gt;8782&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;22&lt;/th&gt;
  &lt;td&gt;SD&lt;/td&gt;
  &lt;td&gt;8758&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;23&lt;/th&gt;
  &lt;td&gt;MIN&lt;/td&gt;
  &lt;td&gt;8712&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;24&lt;/th&gt;
  &lt;td&gt;CAR&lt;/td&gt;
  &lt;td&gt;8668&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;25&lt;/th&gt;
  &lt;td&gt;JAC&lt;/td&gt;
  &lt;td&gt;8656&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;26&lt;/th&gt;
  &lt;td&gt;NYJ&lt;/td&gt;
  &lt;td&gt;8437&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;27&lt;/th&gt;
  &lt;td&gt;KC&lt;/td&gt;
  &lt;td&gt;8373&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;28&lt;/th&gt;
  &lt;td&gt;MIA&lt;/td&gt;
  &lt;td&gt;8236&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;29&lt;/th&gt;
  &lt;td&gt;CLE&lt;/td&gt;
  &lt;td&gt;8156&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;30&lt;/th&gt;
  &lt;td&gt;STL&lt;/td&gt;
  &lt;td&gt;7957&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;31&lt;/th&gt;
  &lt;td&gt;HOU&lt;/td&gt;
  &lt;td&gt;7909&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;32&lt;/th&gt;
  &lt;td&gt;LA&lt;/td&gt;
  &lt;td&gt;1147&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;33&lt;/th&gt;
  &lt;td&gt;JAX&lt;/td&gt;
  &lt;td&gt;110&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;34&lt;/th&gt;
  &lt;td&gt;LAC&lt;/td&gt;
  &lt;td&gt;73&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;35&lt;/th&gt;
  &lt;td&gt;UNK&lt;/td&gt;
  &lt;td&gt;0&lt;/td&gt;
&lt;/tr&gt;</code></pre>
</tbody>
</table>
</div>
<p>Every play in the database is accompanied by a description of what happened on that play. If we wanted to find out which play has the longest description we can use the CHAR_LENGTH function along with ORDER BY DESC.</p>
<pre class="python"><code># play that have the longest description

cur.execute(&quot;&quot;&quot;select description
from play
order by char_length(description) DESC
limit 1&quot;&quot;&quot;)

cur.fetchall()</code></pre>
<pre><code>[(&#39;(:50) (Shotgun) D.Brees pass short left to M.Colston to CLE 22 for 4 yards (E.Wright). FUMBLES (E.Wright), and recovers at CLE 23. M.Colston to CLE 23 for no gain (E.Wright). After the play, the Saints attempted to rush a field goal attempt, as Cleveland through the CHALLENGE flag, asserting that Colston FUMBLED and the ball was recovered by Cleveland.  This challenge was DENIED, as the play was not reviewable. After the third quarter ended, the Saints then challenged the ruling that Colston was down by contact. New Orleans challenged the runner was down by contact ruling, and the play was REVERSED. (Shotgun) D.Brees pass short left to M.Colston to CLE 21 for 5 yards (E.Wright). After the play, the Saints attempted to rush a field goal attempt, as Cleveland through the CHALLENGE flag, asserting that Colston FUMBLED and the ball was recovered by Cleveland.  This challenge was DENIED, as the play was not reviewable. After the third quarter ended, the Saints then challenged the ruling that Colston was down by contact.  The overturn on review negated the fumble.&#39;,)]</code></pre>
<p>I’ve read through that play description a few times and I still don’t know what happened ¯\<em>| ಠ ∧ ಠ |</em>/¯</p>
</div>
<div id="joins" class="section level2">
<h2><span class="header-section-number">2.5</span> JOINS</h2>
<p>Joining data is one of the most important functions of SQL but it is also the one most likely to lead to confusion. There are many <a href="https://www.tutorialspoint.com/postgresql/postgresql_using_joins.htm">resources</a> on SQL joins, but here we will just give a basic example.</p>
<p>Our queries so far have used the entire dataset. For example, the table on most penalty yards was from all years in the <code>play</code> dataset. If we wanted to filter to just one year we would need to bring in the year from the <code>game</code> dataset. This would require us to join the <code>game</code> dataset with the <code>play</code> dataset.</p>
<p>When joining tables, each variable that is selected needs to be prefaced by the name of the table it is coming from followed by a “.”. For example, selecting <code>pos_team</code> from the <code>play</code> dataset would be written as <code>play.pos_team</code>.</p>
<p>This is a very simple join and as such we can match in the tables simply using a WHERE clause that matches the shared game ids (<code>gsis_id</code>) between the two tables. We then filter to the year 2015 and the regular season.</p>
<pre class="python"><code># most penalty yards in 2015; need to join play to game and filter to regular season
pd.read_sql(&quot;&quot;&quot;select play.pos_team, sum(play.penalty_yds)
from play, game where play.gsis_id=game.gsis_id and game.season_year=2015 and game.season_type=&#39;Regular&#39;
group by play.pos_team
order by sum(play.penalty_yds) DESC
limit 10&quot;&quot;&quot;,con=conn)</code></pre>
<div>
<table border="1" class="dataframe">
<thead>
<pre><code>&lt;tr style=&quot;text-align: right;&quot;&gt;
  &lt;th&gt;&lt;/th&gt;
  &lt;th&gt;pos_team&lt;/th&gt;
  &lt;th&gt;sum&lt;/th&gt;
&lt;/tr&gt;</code></pre>
</thead>
<tbody>
<pre><code>&lt;tr&gt;
  &lt;th&gt;0&lt;/th&gt;
  &lt;td&gt;GB&lt;/td&gt;
  &lt;td&gt;1296&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;1&lt;/th&gt;
  &lt;td&gt;TB&lt;/td&gt;
  &lt;td&gt;1152&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;2&lt;/th&gt;
  &lt;td&gt;ARI&lt;/td&gt;
  &lt;td&gt;1149&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;3&lt;/th&gt;
  &lt;td&gt;SD&lt;/td&gt;
  &lt;td&gt;1104&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;4&lt;/th&gt;
  &lt;td&gt;NE&lt;/td&gt;
  &lt;td&gt;1064&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;5&lt;/th&gt;
  &lt;td&gt;PHI&lt;/td&gt;
  &lt;td&gt;1061&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;6&lt;/th&gt;
  &lt;td&gt;BUF&lt;/td&gt;
  &lt;td&gt;1059&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;7&lt;/th&gt;
  &lt;td&gt;STL&lt;/td&gt;
  &lt;td&gt;1029&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;8&lt;/th&gt;
  &lt;td&gt;PIT&lt;/td&gt;
  &lt;td&gt;1023&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;9&lt;/th&gt;
  &lt;td&gt;NYG&lt;/td&gt;
  &lt;td&gt;1020&lt;/td&gt;
&lt;/tr&gt;</code></pre>
</tbody>
</table>
</div>
</div>
<div id="with-subqueries" class="section level2">
<h2><span class="header-section-number">2.6</span> WITH SUBQUERIES</h2>
<p>This is a slightly more advanced topic. WITH statements are a powerful tool that allows you to create sub tables and then join them together. For example, if wanted additional aggregate statistics for each drive not including in the drives dataset, we would have to aggregate these numbers from the play table to the drive level then join it to the drive table. The WITH statement allows us to do this in one query.</p>
<p>For clarity is an example. Let’s say we want the following table:</p>
<table>
<thead>
<tr class="header">
<th>game_id</th>
<th>drive_id</th>
<th>yards_gained</th>
<th>passing_first_downs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>1</td>
<td>40</td>
<td>2</td>
</tr>
<tr class="even">
<td>1</td>
<td>2</td>
<td>70</td>
<td>3</td>
</tr>
<tr class="odd">
<td>1</td>
<td>3</td>
<td>20</td>
<td>0</td>
</tr>
</tbody>
</table>
<p>We would have to join the drive table:</p>
<table>
<thead>
<tr class="header">
<th>game_id</th>
<th>drive_id</th>
<th>yards_gained</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>1</td>
<td>40</td>
</tr>
<tr class="even">
<td>1</td>
<td>2</td>
<td>70</td>
</tr>
<tr class="odd">
<td>1</td>
<td>3</td>
<td>20</td>
</tr>
</tbody>
</table>
<p>With the play table (here is a truncated example — imagine the passing_first_down column sums to 2 where drive_id==1):</p>
<table>
<thead>
<tr class="header">
<th>game_id</th>
<th>drive_id</th>
<th>play_id</th>
<th>passing_first_down</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="even">
<td>1</td>
<td>1</td>
<td>2</td>
<td>1</td>
</tr>
<tr class="odd">
<td>1</td>
<td>1</td>
<td>3</td>
<td>0</td>
</tr>
</tbody>
</table>
<p>We would take the sum of passing_first_down across game_id and drive_id and then link the drive table and the play table on game_id and drive_id.</p>
<pre class="python"><code>pd.read_sql(&quot;&quot;&quot;with plays as
    (select gsis_id, drive_id, sum(passing_first_down) as pass_first, sum(penalty_first_down) as penalty_first, sum(rushing_first_down) as rushing_first, sum(first_down) as first, sum(third_down_conv) as third
    from play
    group by gsis_id, drive_id),
drives as
    (select gsis_id, drive_id, pos_team, result, start_field, pos_time, penalty_yards, yards_gained, play_count
    from drive)
select * from drives
inner join plays on (drives.gsis_id=plays.gsis_id and drives.drive_id=plays.drive_id)
limit 10&quot;&quot;&quot;,con=conn)
</code></pre>
<div>
<table border="1" class="dataframe">
<thead>
<pre><code>&lt;tr style=&quot;text-align: right;&quot;&gt;
  &lt;th&gt;&lt;/th&gt;
  &lt;th&gt;gsis_id&lt;/th&gt;
  &lt;th&gt;drive_id&lt;/th&gt;
  &lt;th&gt;pos_team&lt;/th&gt;
  &lt;th&gt;result&lt;/th&gt;
  &lt;th&gt;start_field&lt;/th&gt;
  &lt;th&gt;pos_time&lt;/th&gt;
  &lt;th&gt;penalty_yards&lt;/th&gt;
  &lt;th&gt;yards_gained&lt;/th&gt;
  &lt;th&gt;play_count&lt;/th&gt;
  &lt;th&gt;gsis_id&lt;/th&gt;
  &lt;th&gt;drive_id&lt;/th&gt;
  &lt;th&gt;pass_first&lt;/th&gt;
  &lt;th&gt;penalty_first&lt;/th&gt;
  &lt;th&gt;rushing_first&lt;/th&gt;
  &lt;th&gt;first&lt;/th&gt;
  &lt;th&gt;third&lt;/th&gt;
&lt;/tr&gt;</code></pre>
</thead>
<tbody>
<pre><code>&lt;tr&gt;
  &lt;th&gt;0&lt;/th&gt;
  &lt;td&gt;2009081350&lt;/td&gt;
  &lt;td&gt;1&lt;/td&gt;
  &lt;td&gt;PIT&lt;/td&gt;
  &lt;td&gt;Punt&lt;/td&gt;
  &lt;td&gt;(-30)&lt;/td&gt;
  &lt;td&gt;(239)&lt;/td&gt;
  &lt;td&gt;4&lt;/td&gt;
  &lt;td&gt;15&lt;/td&gt;
  &lt;td&gt;6&lt;/td&gt;
  &lt;td&gt;2009081350&lt;/td&gt;
  &lt;td&gt;1&lt;/td&gt;
  &lt;td&gt;0&lt;/td&gt;
  &lt;td&gt;0&lt;/td&gt;
  &lt;td&gt;1&lt;/td&gt;
  &lt;td&gt;1&lt;/td&gt;
  &lt;td&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;1&lt;/th&gt;
  &lt;td&gt;2009081350&lt;/td&gt;
  &lt;td&gt;3&lt;/td&gt;
  &lt;td&gt;PIT&lt;/td&gt;
  &lt;td&gt;Punt&lt;/td&gt;
  &lt;td&gt;(-42)&lt;/td&gt;
  &lt;td&gt;(344)&lt;/td&gt;
  &lt;td&gt;-5&lt;/td&gt;
  &lt;td&gt;33&lt;/td&gt;
  &lt;td&gt;8&lt;/td&gt;
  &lt;td&gt;2009081350&lt;/td&gt;
  &lt;td&gt;3&lt;/td&gt;
  &lt;td&gt;2&lt;/td&gt;
  &lt;td&gt;0&lt;/td&gt;
  &lt;td&gt;0&lt;/td&gt;
  &lt;td&gt;2&lt;/td&gt;
  &lt;td&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;2&lt;/th&gt;
  &lt;td&gt;2009081350&lt;/td&gt;
  &lt;td&gt;5&lt;/td&gt;
  &lt;td&gt;PIT&lt;/td&gt;
  &lt;td&gt;Field Goal&lt;/td&gt;
  &lt;td&gt;(-39)&lt;/td&gt;
  &lt;td&gt;(193)&lt;/td&gt;
  &lt;td&gt;-5&lt;/td&gt;
  &lt;td&gt;62&lt;/td&gt;
  &lt;td&gt;6&lt;/td&gt;
  &lt;td&gt;2009081350&lt;/td&gt;
  &lt;td&gt;5&lt;/td&gt;
  &lt;td&gt;1&lt;/td&gt;
  &lt;td&gt;0&lt;/td&gt;
  &lt;td&gt;0&lt;/td&gt;
  &lt;td&gt;1&lt;/td&gt;
  &lt;td&gt;0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;3&lt;/th&gt;
  &lt;td&gt;2009081350&lt;/td&gt;
  &lt;td&gt;12&lt;/td&gt;
  &lt;td&gt;PIT&lt;/td&gt;
  &lt;td&gt;Punt&lt;/td&gt;
  &lt;td&gt;(-22)&lt;/td&gt;
  &lt;td&gt;(55)&lt;/td&gt;
  &lt;td&gt;0&lt;/td&gt;
  &lt;td&gt;7&lt;/td&gt;
  &lt;td&gt;3&lt;/td&gt;
  &lt;td&gt;2009081350&lt;/td&gt;
  &lt;td&gt;12&lt;/td&gt;
  &lt;td&gt;0&lt;/td&gt;
  &lt;td&gt;0&lt;/td&gt;
  &lt;td&gt;0&lt;/td&gt;
  &lt;td&gt;0&lt;/td&gt;
  &lt;td&gt;0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;4&lt;/th&gt;
  &lt;td&gt;2009081350&lt;/td&gt;
  &lt;td&gt;14&lt;/td&gt;
  &lt;td&gt;PIT&lt;/td&gt;
  &lt;td&gt;Punt&lt;/td&gt;
  &lt;td&gt;(-40)&lt;/td&gt;
  &lt;td&gt;(92)&lt;/td&gt;
  &lt;td&gt;0&lt;/td&gt;
  &lt;td&gt;8&lt;/td&gt;
  &lt;td&gt;3&lt;/td&gt;
  &lt;td&gt;2009081350&lt;/td&gt;
  &lt;td&gt;14&lt;/td&gt;
  &lt;td&gt;0&lt;/td&gt;
  &lt;td&gt;0&lt;/td&gt;
  &lt;td&gt;0&lt;/td&gt;
  &lt;td&gt;0&lt;/td&gt;
  &lt;td&gt;0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;5&lt;/th&gt;
  &lt;td&gt;2009081350&lt;/td&gt;
  &lt;td&gt;15&lt;/td&gt;
  &lt;td&gt;ARI&lt;/td&gt;
  &lt;td&gt;Interception&lt;/td&gt;
  &lt;td&gt;(-4)&lt;/td&gt;
  &lt;td&gt;(29)&lt;/td&gt;
  &lt;td&gt;-10&lt;/td&gt;
  &lt;td&gt;0&lt;/td&gt;
  &lt;td&gt;1&lt;/td&gt;
  &lt;td&gt;2009081350&lt;/td&gt;
  &lt;td&gt;15&lt;/td&gt;
  &lt;td&gt;0&lt;/td&gt;
  &lt;td&gt;0&lt;/td&gt;
  &lt;td&gt;0&lt;/td&gt;
  &lt;td&gt;0&lt;/td&gt;
  &lt;td&gt;0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;6&lt;/th&gt;
  &lt;td&gt;2009081350&lt;/td&gt;
  &lt;td&gt;20&lt;/td&gt;
  &lt;td&gt;PIT&lt;/td&gt;
  &lt;td&gt;Punt&lt;/td&gt;
  &lt;td&gt;(-16)&lt;/td&gt;
  &lt;td&gt;(77)&lt;/td&gt;
  &lt;td&gt;-5&lt;/td&gt;
  &lt;td&gt;3&lt;/td&gt;
  &lt;td&gt;3&lt;/td&gt;
  &lt;td&gt;2009081350&lt;/td&gt;
  &lt;td&gt;20&lt;/td&gt;
  &lt;td&gt;0&lt;/td&gt;
  &lt;td&gt;0&lt;/td&gt;
  &lt;td&gt;0&lt;/td&gt;
  &lt;td&gt;0&lt;/td&gt;
  &lt;td&gt;0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;7&lt;/th&gt;
  &lt;td&gt;2009081350&lt;/td&gt;
  &lt;td&gt;23&lt;/td&gt;
  &lt;td&gt;ARI&lt;/td&gt;
  &lt;td&gt;End of Game&lt;/td&gt;
  &lt;td&gt;(-18)&lt;/td&gt;
  &lt;td&gt;(101)&lt;/td&gt;
  &lt;td&gt;5&lt;/td&gt;
  &lt;td&gt;55&lt;/td&gt;
  &lt;td&gt;10&lt;/td&gt;
  &lt;td&gt;2009081350&lt;/td&gt;
  &lt;td&gt;23&lt;/td&gt;
  &lt;td&gt;3&lt;/td&gt;
  &lt;td&gt;0&lt;/td&gt;
  &lt;td&gt;1&lt;/td&gt;
  &lt;td&gt;4&lt;/td&gt;
  &lt;td&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;8&lt;/th&gt;
  &lt;td&gt;2009081351&lt;/td&gt;
  &lt;td&gt;1&lt;/td&gt;
  &lt;td&gt;PHI&lt;/td&gt;
  &lt;td&gt;Punt&lt;/td&gt;
  &lt;td&gt;(-23)&lt;/td&gt;
  &lt;td&gt;(100)&lt;/td&gt;
  &lt;td&gt;-10&lt;/td&gt;
  &lt;td&gt;16&lt;/td&gt;
  &lt;td&gt;3&lt;/td&gt;
  &lt;td&gt;2009081351&lt;/td&gt;
  &lt;td&gt;1&lt;/td&gt;
  &lt;td&gt;0&lt;/td&gt;
  &lt;td&gt;0&lt;/td&gt;
  &lt;td&gt;0&lt;/td&gt;
  &lt;td&gt;0&lt;/td&gt;
  &lt;td&gt;0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;th&gt;9&lt;/th&gt;
  &lt;td&gt;2009081351&lt;/td&gt;
  &lt;td&gt;3&lt;/td&gt;
  &lt;td&gt;PHI&lt;/td&gt;
  &lt;td&gt;Punt&lt;/td&gt;
  &lt;td&gt;(-28)&lt;/td&gt;
  &lt;td&gt;(54)&lt;/td&gt;
  &lt;td&gt;0&lt;/td&gt;
  &lt;td&gt;3&lt;/td&gt;
  &lt;td&gt;3&lt;/td&gt;
  &lt;td&gt;2009081351&lt;/td&gt;
  &lt;td&gt;3&lt;/td&gt;
  &lt;td&gt;0&lt;/td&gt;
  &lt;td&gt;0&lt;/td&gt;
  &lt;td&gt;0&lt;/td&gt;
  &lt;td&gt;0&lt;/td&gt;
  &lt;td&gt;0&lt;/td&gt;
&lt;/tr&gt;</code></pre>
</tbody>
</table>
</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
